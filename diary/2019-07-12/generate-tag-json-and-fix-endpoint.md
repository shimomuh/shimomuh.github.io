# タグを分類するための JSON 生成とエンドポイントの修正

タグ `このサイトの生い立ち` `Ruby` `設計`

## 対象者

このサイトの生い立ちを追ってきた人

## 背景

タイトルの通り、タグをリンクにしてタグに関する記事をまとめたいなと思ったのでその JSON を生成する仕組みとエンドポイントの見直しを行った

## 結論

[→成果](https://github.com/shimomuh/shimomuh.github.io/commit/b2150ce16dfd0c9132280e29d8bf0e267c5ecf4a)

JSON 吐き出しについてはタイトルのときと類似なので割愛して今回はエンドポイントの見直しについて少し触れる

 

今回は閲覧もほぼされてないだろうと割り切りエンドポイントをざっくり以下のように変更した

```diff
- /2019-07-12
+ /diary/2019-07-12
```

こうすることで、 `/tag/**` が切りやすくなるという次第である

しかし本来はこういったものはすでに閲覧が多いサイトなどでは容易にはいかない

エンドポイントを被らないようにしながら一定期間リダイレクトをかけたり歪な URL 設計を許容したりする必要がある

そういう意味でもエンドポイントの設計は最初からされるべきだ

 

とはいえ、サービスは日々改善され新しい機能が実装されるごとにエンドポイントが増えることが往往にしてある

そのため、 ~（今回ほどひどい設計はしないまでも）~ ある程度最初にエンドポイントを設計して、あとは柔軟に対応していく必要がある

 

次回はいよいよタグのエンドポイントを切ろうと思うが、日本語URL設計やファイル名をどうするかについては検討の余地がある（もちろん id にしてしまえば楽ではあるのだが、JSON で書き出す場合は DB のように恒久的にその ID を保証しきれないので）
